<!--
Copyright (c) 2024 Themba Mzumara
This file is part of SwissJS Framework. All rights reserved.
Licensed under the MIT License. See LICENSE in the project root for license information.
-->

# Phase 3 Snapshot â€” Compiler Integration

Date: 2025-08-11

This snapshot captures the finalized state of the SwissJS compiler codegen pipeline at the end of Phase 3.

## Summary

- Decorator-based codegen fully handled by AST transformers; runtime decorators are removed and replaced with explicit registration/metadata.
- Guarded `.1ui` template pipeline integrated and validated.
- Standardized diagnostics in place; imported-constant `@requires` resolution implemented.
- Workspace build is green (7/7 packages) and CLI type issues resolved.

## Key Artifacts

- Pipeline Overview: `docs/compiler/phase-3/pipeline-overview.md`
- Compiler Entry: `packages/compiler/src/index.ts`
- Transformers: `packages/compiler/src/transformers/*.ts`
- Template Parser/Emitter: `packages/compiler/src/template-parser.ts`
- Optimizer (prototype): `packages/compiler/src/optimizer.ts`

## Tests

- Added tests:
  - `packages/compiler/__tests__/invalid-oneui-import.test.ts`
  - `packages/compiler/__tests__/oneui-import-rewrite.test.ts`
- Existing tests:
  - `lifecycle-render-transformer.test.ts`
  - `plugin-service-transformer.test.ts`
  - `template-integration.test.ts`
  - `tsx-transform.test.tsx`
  - `capability-import-resolution.test.ts`
  - `compiler.test.ts`

Result: 8 files, 22 tests passing via `pnpm -F @swissjs/compiler test`.

## Configuration Anchors

- TypeScript (root `tsconfig.base.json`):
  - `experimentalDecorators: true`, `emitDecoratorMetadata: true`
  - `moduleResolution: node16`, `verbatimModuleSyntax: true`
  - `paths` for `@swissjs/core` point to `src/index.ts` with dist fallback; deep imports map to `src/*` then `dist/*`.

## Downstream Stability

- `@swissjs/plugin-file-router` resolves `@swissjs/core` declarations cleanly (TS7016 resolved).
- `@swissjs/cli` stabilized:
  - `vite` aligned to `^5.4.19`
  - `@types/node` unified at `18.19.121`
  - Vite server `https` typing fixed; temporary ambient module declarations added for `helmet`, `http-proxy-middleware`, `handlebars`.

## Follow-ups (Post-Phase 3)

- Remove ambient declarations in CLI once TS reliably picks up package-provided types under current moduleResolution.
- Continue enforcing and verifying barrel exports across all remaining packages.
- Consider additional end-to-end performance/scale tests for very large `.1ui` files.

## Status

Phase 3 is locked. This snapshot reflects the final state at completion.
